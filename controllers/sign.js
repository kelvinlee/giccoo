var EventProxy,User,Ut,check,checkAdmin,config;User=require("../proxy").User,check=require("validator").check,EventProxy=require("eventproxy"),config=require("../config").config,Ut=require("../lib/util"),checkAdmin=function(e,r){return e.session.is_admin?!0:(r.render("404"),!1)},exports["in"]=function(e,r){return r.render("admin/signin"),!1},exports.out=function(e,r){return!1},exports.register=function(e,r){return r.render("admin/register"),!1},exports.post=function(e,r){var n,o,t;return n=Ut.strim(e.body.username),o=Ut.strim(e.body.password),t=Ut.recode(),Ut.empty(o)&&(t.reason="empty password",t.recode=201),Ut.empty(n)&&(t.reason="empty username",t.recode=201),200===t.recode?(User.getUserLogin(n,o,function(e,n){var o,s;return e?(console.log(e),t.reason="empty username",t.recode=201):n.length>0?(s=Ut.encrypt(n[0]._id+"	"+n[0].name+"	"+n[0].email,"giccoo"),o=6048e5,r.cookie("user",s,{expires:new Date(Date.now()+604800,{maxAge:o})})):(t.reason="none",t.recode=201),r.send(t)}),!1):(r.send(t),!1)},exports.reg=function(e,r){var n,o,t,s;return console.log(Ut.strim(" sdf ")),o=Ut.strim(e.body.username),t=Ut.strim(e.body.password),n=Ut.strim(e.body.email),s=Ut.recode(),console.log(s),Ut.empty(t)&&(s.reason="empty password",s.recode=201),Ut.empty(o)&&(s.reason="empty username",s.recode=201),Ut.empty(n)&&(s.reason="empty email",s.recode=201),200===s.recode&&User.newAndSave(o,t,n,"",!0,1,"",function(e,n){return e?(console.log(e),s.reason="empty username",s.recode=201):n||(s.reason=n,s.recode=201),r.send(s),!1}),r.send(s),!1};