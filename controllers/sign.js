var EventProxy,User,Ut,check,checkAdmin,config;User=require("../proxy").User,check=require("validator").check,EventProxy=require("eventproxy"),config=require("../config").config,Ut=require("../lib/util"),checkAdmin=function(e,r){return e.session.is_admin?!0:(r.render("404"),!1)},exports["in"]=function(e,r){return r.render("admin/signin"),!1},exports.out=function(e,r){return!1},exports.register=function(e,r){return r.render("admin/register"),!1},exports.post=function(e,r){var o,n,t;return o=Ut.strim(e.body.username),n=Ut.strim(e.body.password),t=Ut.recode(),Ut.empty(n)&&(t.reason="empty password",t.recode=201),Ut.empty(o)&&(t.reason="empty username",t.recode=201),200===t.recode?(User.getUserLogin(o,n,function(e,o){var n,s;return e?(console.log(e),t.reason="empty username",t.recode=201):o.length>0?(s=Ut.encrypt(o[0]._id+"	"+o[0].name+"	"+o[0].email,"giccoo"),n=6048e5,r.cookie("user",s,{expires:new Date(Date.now()+604800,{maxAge:n})})):(t.reason="none",t.recode=201),r.send(t)}),!1):(r.send(t),!1)},exports.reg=function(e,r){var o,n,t,s;return console.log(typeof Ut.strim("aa")),console.log(Ut.recode()),n=Ut.strim(e.body.username),t=Ut.strim(e.body.password),o=Ut.strim(e.body.email),s=Ut.recode(),console.log(s),Ut.empty(t)&&(s.reason="empty password",s.recode=201),Ut.empty(n)&&(s.reason="empty username",s.recode=201),Ut.empty(o)&&(s.reason="empty email",s.recode=201),200===s.recode&&User.newAndSave(n,t,o,"",!0,1,"",function(e,o){return e?(console.log(e),s.reason="empty username",s.recode=201):o||(s.reason=o,s.recode=201),r.send(s),!1}),r.send(s),!1};